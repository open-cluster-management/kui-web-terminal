#!/bin/rbash

# Licensed Materials - Property of IBM
# Copyright IBM Corporation 2018, 2019. All Rights Reserved.
# U.S. Government Users Restricted Rights -
# Use, duplication or disclosure restricted by GSA ADP
# IBM Corporation - initial API and implementation

_add_tls=false

if [[ $# = 0 ]]; then
    _add_tls=false
else
    _helm_tls_cmds=('version' 'upgrade' 'test' 'status' 'rollback' 'reset' 'list' 'ls' 'install' 'history' 'hist' 'get' 'delete' 'del');
    for _helm_cmd in "${_helm_tls_cmds[@]}"; do
        if [ "$1" = "$_helm_cmd" ]; then
            _add_tls=true && break
        fi
    done
    for var in "$@"; do
        if [ "$var" == "--tls" -o "$var" == "--help" -o "$var" == "-h" ]; then
            _add_tls=false && break
        fi
    done
fi

if $_add_tls; then
    helm_original "$@" --tls
else
    helm_original "$@"
fi
